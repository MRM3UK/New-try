<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ultimate M3U Player</title>
  <style>
    /* Core styling (more details below for extended UI) */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }body {
  font-family: 'Segoe UI', sans-serif;
  background-color: #121212;
  color: #fff;
}

.container {
  max-width: 1300px;
  margin: auto;
  padding: 20px;
}

h1 {
  text-align: center;
  margin-bottom: 30px;
  color: #00ffe1;
  font-size: 2.5rem;
}

.controls {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 20px;
  align-items: center;
}

.controls input,
.controls button,
.controls select {
  padding: 10px;
  border-radius: 5px;
  border: none;
}

.controls input[type="text"] {
  flex: 1;
  background-color: #1f1f1f;
  color: #fff;
}

.controls button {
  background-color: #00ffe1;
  color: #000;
  cursor: pointer;
}

.controls button:hover {
  background-color: #00c8b0;
}

.theme-toggle {
  margin-left: auto;
  background: #333;
  color: #fff;
}

.video-player {
  width: 100%;
  max-height: 600px;
  background: #000;
  border-radius: 8px;
  margin-bottom: 20px;
}

#channel-search {
  width: 100%;
  margin-bottom: 20px;
  padding: 10px;
  border-radius: 5px;
  border: none;
  background-color: #1f1f1f;
  color: #fff;
}

.channel-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 12px;
}

.channel {
  display: flex;
  align-items: center;
  padding: 12px;
  background-color: #1f1f1f;
  border-radius: 8px;
  transition: background 0.3s;
  cursor: pointer;
}

.channel:hover {
  background-color: #2b2b2b;
}

.channel img {
  width: 48px;
  height: 48px;
  margin-right: 10px;
}

.channel-info {
  flex-grow: 1;
}

.channel-name {
  font-size: 1.1rem;
  font-weight: bold;
}

.channel-group {
  font-size: 0.9rem;
  color: #aaa;
}

.favorite {
  font-size: 1.3rem;
  cursor: pointer;
  color: gold;
}

.error-message {
  color: #ff4c4c;
  margin: 10px 0;
}

  </style>
</head>
<body>
  <div class="container">
    <h1>Ultimate M3U Playlist Player</h1><div class="controls">
  <input type="text" id="playlist-url" placeholder="Enter M3U/M3U8 URL" />
  <button onclick="loadPlaylist()">Load</button>
  <button onclick="clearFavorites()">Clear Favorites</button>
  <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
</div>

<input type="text" id="channel-search" placeholder="Search channels..." oninput="searchChannels()" />

<video id="videoPlayer" class="video-player" controls autoplay></video>
<p id="error-message" class="error-message"></p>

<div id="channel-list" class="channel-list"></div>

  </div>  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>  <script>
    const video = document.getElementById('videoPlayer');
    const channelList = document.getElementById('channel-list');
    const errorMsg = document.getElementById('error-message');
    const searchInput = document.getElementById('channel-search');
    let allChannels = [];
    let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');

    function loadPlaylist() {
      const url = document.getElementById('playlist-url').value.trim();
      if (!url) return;
      errorMsg.textContent = '';
      channelList.innerHTML = '';
      allChannels = [];

      fetch(url)
        .then(res => res.text())
        .then(text => {
          const lines = text.split('\n');
          for (let i = 0; i < lines.length; i++) {
            if (lines[i].startsWith('#EXTINF')) {
              const info = lines[i];
              const name = (info.match(/,(.*)/) || [])[1] || 'Unknown';
              const logo = (info.match(/tvg-logo="(.*?)"/) || [])[1] || '';
              const group = (info.match(/group-title="(.*?)"/) || [])[1] || 'Other';
              const stream = lines[i + 1] || '';
              if (stream.startsWith('http')) {
                allChannels.push({ name, logo, group, stream });
              }
            }
          }
          renderChannels(allChannels);
          if (allChannels.length > 0) playStream(allChannels[0].stream);
        })
        .catch(err => errorMsg.textContent = 'Failed to load playlist: ' + err.message);
    }

    function renderChannels(channels) {
      channelList.innerHTML = '';
      channels.forEach(ch => {
        const item = document.createElement('div');
        item.className = 'channel';
        item.onclick = () => playStream(ch.stream);

        const img = document.createElement('img');
        img.src = ch.logo || 'https://via.placeholder.com/48';

        const info = document.createElement('div');
        info.className = 'channel-info';
        info.innerHTML = `<div class='channel-name'>${ch.name}</div><div class='channel-group'>${ch.group}</div>`;

        const fav = document.createElement('div');
        fav.className = 'favorite';
        fav.textContent = favorites.includes(ch.name) ? '★' : '☆';
        fav.onclick = (e) => {
          e.stopPropagation();
          toggleFavorite(ch.name);
          fav.textContent = favorites.includes(ch.name) ? '★' : '☆';
        };

        item.appendChild(img);
        item.appendChild(info);
        item.appendChild(fav);

        channelList.appendChild(item);
      });
    }

    function playStream(url) {
      if (window.hls) window.hls.destroy();
      if (Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(video);
        window.hls = hls;
      } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = url;
      } else {
        errorMsg.textContent = 'Your browser does not support HLS streaming';
      }
      video.play();
    }

    function searchChannels() {
      const keyword = searchInput.value.toLowerCase();
      const filtered = allChannels.filter(c => c.name.toLowerCase().includes(keyword));
      renderChannels(filtered);
    }

    function toggleFavorite(name) {
      if (favorites.includes(name)) {
        favorites = favorites.filter(f => f !== name);
      } else {
        favorites.push(name);
      }
      localStorage.setItem('favorites', JSON.stringify(favorites));
    }

    function clearFavorites() {
      favorites = [];
      localStorage.removeItem('favorites');
      renderChannels(allChannels);
    }

    function toggleTheme() {
      document.body.classList.toggle('light');
    }
  </script></body>
</html>
